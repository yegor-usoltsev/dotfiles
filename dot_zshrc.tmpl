export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"

export EDITOR="micro"
export VISUAL="micro"

export LESS="-R --mouse"
export LS_COLORS="$(vivid generate tokyonight-night)"

eval "$(mise activate zsh)"

ZSH_CACHE_DIR="$HOME/.cache/zsh"
mkdir -p "$ZSH_CACHE_DIR"
FPATH="$(brew --prefix)/share/zsh/site-functions:$ZSH_CACHE_DIR:$FPATH"

if [[ ! -f "/tmp/.completions_generated" ]]; then
	chezmoi completion zsh >"$ZSH_CACHE_DIR/_chezmoi" 2>/dev/null || true
	touch "/tmp/.completions_generated"
fi

autoload -Uz compinit
compinit -C -d "$ZSH_CACHE_DIR/.zcompdump"

zstyle ':completion:*' cache-path "$ZSH_CACHE_DIR"
zstyle ':completion:*' group-name ''
zstyle ':completion:*' list-colors "$LS_COLORS"
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'
zstyle ':completion:*' menu select
zstyle ':completion:*' squeeze-slashes true
zstyle ':completion:*' use-cache on
zstyle ':completion:*:descriptions' format '%F{yellow}-- %d --%f'
zstyle ':completion:*:warnings' format '%F{red}-- no matches found --%f'

HISTFILE="$HOME/.zsh_history"
HISTSIZE=50000
SAVEHIST=50000

setopt AUTO_CD
setopt CORRECT
setopt EXTENDED_HISTORY
setopt GLOB_DOTS
setopt HIST_FIND_NO_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_REDUCE_BLANKS
setopt HIST_SAVE_NO_DUPS
setopt HIST_VERIFY
setopt INC_APPEND_HISTORY
setopt INTERACTIVE_COMMENTS
setopt NO_BEEP
setopt SHARE_HISTORY

autoload -Uz up-line-or-beginning-search down-line-or-beginning-search
zle -N up-line-or-beginning-search
zle -N down-line-or-beginning-search
bindkey "${terminfo[kcuu1]}" up-line-or-beginning-search
bindkey "${terminfo[kcud1]}" down-line-or-beginning-search
bindkey "^[[A" up-line-or-beginning-search
bindkey "^[[B" down-line-or-beginning-search

eval "$(zoxide init zsh --cmd cd)"

alias l='eza -lah --group-directories-first'
alias ls='eza --group-directories-first'
alias lt='eza --tree --level=2 --group-directories-first'

alias cat='bat --paging=never --style=plain'
alias find='fd'
alias grep='rg'

alias df='duf'
alias du='dust'
alias ps='procs'

alias htop='btop'
alias top='btop'

alias ld='lazydocker'
alias lg='lazygit'

alias nano='micro'

alias compress='ouch compress'
alias decompress='ouch decompress'
alias extract='ouch decompress'

alias claude='claude --dangerously-skip-permissions'
alias codex='codex --dangerously-bypass-approvals-and-sandbox'

eval "$(starship init zsh)"
